#!/usr/bin/env fish

if test (count $argv) -eq 0
  echo $argv[1]
  printf "usage: c <user/repo>\n"
  exit 1
end

set user (echo $argv[1] | sed 's|/.*||')
set repo (echo $argv[1] | sed 's|.*/||')
set projectdir "$PROJECTS/$argv[1]"
set userdir "$PROJECTS/$user"

if test -z $PROJECTS
  printf "PROJECTS env var not set, exiting\n"
  exit 1
end

function clone_project
  if test ! -d $userdir
    mkdir $userdir
  end

  cd $userdir; or exit 1
  git clone "git@github.com:$user/$repo.git"
end

if test ! -d $projectdir
  clone_project
end
